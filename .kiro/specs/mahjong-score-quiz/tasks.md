# 実装計画

- [x] 1. プロジェクトのセットアップと基本構造の構築
  - React + TypeScript + Viteでプロジェクトを初期化
  - Tailwind CSSをセットアップ
  - ディレクトリ構造を作成（components, domain, services, types）
  - テスト環境をセットアップ（Vitest、fast-check、React Testing Library）
  - _要件: 8.1, 8.2_

- [x] 2. データモデルとTypeScript型定義の作成
  - 牌（Tile）、手牌（Hand）、問題（Problem）などの型定義を作成
  - ゲーム設定（GameSettings）と統計情報（Statistics）の型定義を作成
  - _要件: 8.2_

- [x] 3. 麻雀点数計算ロジックの実装
- [x] 3.1 ScoreCalculatorクラスの基本実装
  - 符計算メソッド（calculateFu）を実装
  - 飜数計算メソッド（calculateHan）を実装
  - 点数計算メソッド（calculateScore）を実装
  - _要件: 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ]* 3.2 プロパティテスト: 点数計算の一貫性
  - **プロパティ 10: 点数計算の一貫性**
  - **検証: 要件 5.1, 5.2, 5.3**

- [ ]* 3.3 プロパティテスト: 親子点数比の正確性
  - **プロパティ 11: 親子点数比の正確性**
  - **検証: 要件 5.4**

- [x] 4. ルール設定機能の実装
- [x] 4.1 GameSettingsの管理機能を実装
  - デフォルト設定の定義
  - ローカルストレージへの保存機能
  - ローカルストレージからの読み込み機能
  - _要件: 7.1, 7.2, 7.3, 7.5_

- [ ]* 4.2 プロパティテスト: 設定の永続化ラウンドトリップ
  - **プロパティ 15: 設定の永続化ラウンドトリップ**
  - **検証: 要件 7.5**

- [x] 4.3 ScoreCalculatorにルール設定を統合
  - 赤ドラ設定を飜数計算に反映
  - 喰いタン設定を役判定に反映
  - 後付け設定を役判定に反映
  - _要件: 7.4_

- [ ]* 4.4 プロパティテスト: 赤ドラ設定の反映
  - **プロパティ 13: 赤ドラ設定の反映**
  - **検証: 要件 7.1, 7.4**

- [ ]* 4.5 プロパティテスト: 喰いタン設定の反映
  - **プロパティ 14: 喰いタン設定の反映**
  - **検証: 要件 7.2, 7.4**

- [x] 5. 問題生成ロジックの実装
- [x] 5.1 ProblemGeneratorクラスの実装
  - ランダムな手牌を生成する機能
  - 難易度に応じた問題生成
  - 選択肢を生成する機能（正解を含む）
  - _要件: 1.1, 1.2, 6.1, 6.2, 6.3, 6.4_

- [ ]* 5.2 プロパティテスト: 有効な手牌の生成
  - **プロパティ 1: 有効な手牌の生成**
  - **検証: 要件 1.1**

- [ ]* 5.3 プロパティテスト: 選択肢の完全性
  - **プロパティ 2: 選択肢の完全性**
  - **検証: 要件 1.2**

- [ ]* 5.4 プロパティテスト: 難易度の多様性
  - **プロパティ 12: 難易度の多様性**
  - **検証: 要件 6.4**

- [x] 6. クイズ管理ロジックの実装
- [x] 6.1 QuizManagerクラスの実装
  - 問題生成機能（generateProblem）
  - 回答判定機能（checkAnswer）
  - 統計情報管理機能（getStatistics）
  - セッションリセット機能（resetSession）
  - _要件: 1.3, 1.4, 1.5, 3.1, 3.2, 3.3, 4.2_

- [ ]* 6.2 プロパティテスト: 回答完全性チェック
  - **プロパティ 3: 回答完全性チェック**
  - **検証: 要件 1.3**

- [ ]* 6.3 プロパティテスト: 判定の正確性
  - **プロパティ 4: 判定の正確性**
  - **検証: 要件 1.4**

- [ ]* 6.4 プロパティテスト: 正解表示の正確性
  - **プロパティ 5: 正解表示の正確性**
  - **検証: 要件 1.5**

- [ ]* 6.5 プロパティテスト: 統計の累積性
  - **プロパティ 7: 統計の累積性**
  - **検証: 要件 3.1, 3.2**

- [ ]* 6.6 プロパティテスト: 統計計算の正確性
  - **プロパティ 8: 統計計算の正確性**
  - **検証: 要件 3.3**

- [ ]* 6.7 プロパティテスト: 次の問題の独立性
  - **プロパティ 9: 次の問題の独立性**
  - **検証: 要件 4.2**

- [x] 7. 状態管理の実装
- [x] 7.1 React Context APIで状態管理を実装
  - SessionStateの管理
  - 現在の問題、ユーザー回答、統計情報の状態管理
  - ルール設定の状態管理
  - _要件: 8.4_

- [x] 8. UIコンポーネントの実装
- [x] 8.1 HandDisplayコンポーネントの実装
  - 牌を視覚的に表示
  - 鳴きや和了牌の強調表示
  - レスポンシブデザイン対応
  - _要件: 2.1, 2.5_

- [x] 8.2 AnswerSelectorコンポーネントの実装
  - 符・飜数・点数の選択肢をボタンで表示
  - 選択状態の視覚的フィードバック
  - 正解・不正解の表示
  - _要件: 1.2, 2.2, 2.3, 2.4_

- [ ]* 8.3 プロパティテスト: 選択状態の反映
  - **プロパティ 6: 選択状態の反映**
  - **検証: 要件 2.3**

- [x] 8.4 StatisticsDisplayコンポーネントの実装
  - 回答数、正解数、不正解数の表示
  - 正解率の表示
  - _要件: 3.1, 3.2, 3.3_

- [x] 8.5 SettingsPanelコンポーネントの実装
  - 赤ドラ、喰いタン、後付けの設定切り替え
  - 設定の保存
  - _要件: 7.1, 7.2, 7.3, 7.5_

- [x] 8.6 ResultModalコンポーネントの実装
  - 正解・不正解の表示
  - 正解の符・飜数・点数の表示
  - 次の問題ボタン
  - _要件: 1.4, 1.5, 4.1_

- [x] 9. メインのQuizScreenコンポーネントの実装
- [x] 9.1 QuizScreenコンポーネントの実装
  - すべてのサブコンポーネントを統合
  - 問題の表示と回答フロー
  - 次の問題ボタンと終了ボタン
  - セッション終了時の統計表示
  - _要件: 1.1, 1.2, 1.3, 1.4, 1.5, 4.1, 4.2, 4.3, 4.4_

- [ ]* 9.2 ユニットテスト: UIコンポーネント
  - HandDisplayコンポーネントのテスト
  - AnswerSelectorコンポーネントのテスト
  - StatisticsDisplayコンポーネントのテスト
  - _要件: 2.1, 2.2, 2.3_

- [x] 10. スタイリングとレスポンシブデザインの実装
- [x] 10.1 Tailwind CSSでスタイリング
  - シンプルでわかりやすいUIデザイン
  - 色や記号で直感的な正解・不正解表示
  - モバイル端末対応のレスポンシブデザイン
  - _要件: 2.1, 2.2, 2.4, 2.5_

- [x] 11. パフォーマンス最適化
- [x] 11.1 レスポンス時間の最適化
  - 回答判定の高速化
  - 問題生成の高速化
  - 初回読み込みの最適化
  - _要件: 9.1, 9.2, 9.3_

- [ ]* 11.2 プロパティテスト: レスポンス時間の保証
  - **プロパティ 16: レスポンス時間の保証**
  - **検証: 要件 9.1, 9.2**

- [x] 12. エラーハンドリングの実装
- [x] 12.1 エラーハンドリングの追加
  - 無効な手牌データのエラー処理
  - 計算エラーの処理
  - ローカルストレージエラーの処理
  - 問題生成エラーの処理
  - 日本語エラーメッセージの実装
  - _要件: すべて_

- [x] 13. 最終チェックポイント - すべてのテストが通ることを確認
  - すべてのテストが通ることを確認し、問題があればユーザーに質問する
